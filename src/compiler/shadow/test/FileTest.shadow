import shadow.io@CanClose;
import shadow.io@CanRead;
import shadow.io@CanWrite;
import shadow.io@Path;
import shadow.io@File;
import shadow.io@IOException;
import shadow.io@Console;

class shadow.test@FileTest
{
	public main( String[] args ) => ()
	{
		Console console = Console:instance;
		nullable File nullableFile = null;
		try
		{
			File file = File:create(args[0]);
			nullableFile = file;
			try
			{
				console.printLine("try begin");
				file->exists = true;
				console.printLine("try end");
			}
			catch ( IOException ex )
			{
				console.printLine("catch ( " # ex # " )");
			}
			finally
			{
				console.printLine("finally");
			}
			String line = console.readLine();
			byte[] chars = line->chars;
			file.write(chars);
			file->size = file->position;
			file.read(chars);
			console.printLine(String:create(chars));
		}
		catch ( IOException ex )
		{
			console.printLine(ex);
		}
		finally
		{
			try
			{
				check(nullableFile).close();
			}
			recover
			{
			}
		}
	}
}
