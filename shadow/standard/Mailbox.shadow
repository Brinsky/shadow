import shadow:utility@LinkedList;
import shadow:natives;

/**
 * @author Claude Abounegm
 */
class shadow:standard@
	Mailbox<T is CanEqual<T>>
{
	Mutex mutex;
	LinkedList<T> queue;
	
	public create()
	{
		mutex = Mutex:create();
		queue = LinkedList<T>:create();
	}
	
	public enqueue(T data) => ()
	{
		mutex.lock();
		queue.addLast(copy(data));
		mutex.unlock();
	}
	
	public dequeue() => (T)
	{
		mutex.lock();
		var retVal = queue.removeFirst();
		mutex.unlock();
		
		return retVal;
	}
}