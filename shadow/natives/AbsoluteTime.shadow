import shadow:io@Console;

/**
* @author Claude Abounegm
*/
locked class shadow:natives@
	AbsoluteTime
{
	private native readonly setAbsoluteTime(Pointer time, int sec, int nsec) => ();
	private native readonly get handleSize() => (int);
	
	Handle handle;
	
	public create(TimeSpan ts)
	{
		handle = Handle:create(this->handleSize);

		var absTime = ts + Time->epochNow;
		setAbsoluteTime(this->ptr, cast<int>(absTime->totalSeconds), absTime->nanoSeconds);
	}
	
	public readonly get ptr() => (Pointer ptr)
	{
		return handle->ptr;
	}
	
	public free() => ()
	{
		try {
			handle.free();
		} catch(Exception e) {}
	}
}